# lamp -> amazon linux 
# httpd, mariadb105-server, php , php-mysqlnd php-fpm installation
---
- name: install,start,enable LAMP stack
  hosts: localhost
  become: yes #to assign sudo privileges
  tasks:
    - name: install httpd, mariadb105-server, php, php-mysqlnd, php-fpm
      #install httpd
      ansible.builtin.dnf:
        name: httpd
        state: present
      #install mariadb105-server
    - name: install mariadb105-server
      ansible.builtin.dnf: 
        name: mariadb105-server
        state: present
      #install php and php-mysqlnd
    - name: install php and php-fpm
      ansible.builtin.dnf:
        name: 
          - php 
          - php-fpm
        state: present  
    # start and enable httpd service
    - name: start httpd service
      ansible.builtin.systemd_service:
        name: httpd
        state: started
        enabled: true
    # start and enable mariadb service
    - name: start mariadb service 
      ansible.builtin.systemd_service:
        name: mariadb
        state: started
        enabled: true
    #start and enable php-fpm service
    - name: start php-fpm service 
      ansible.builtin.systemd_service:
        name: php-fpm
        state: started
        enabled: true
    #deploy index.php file
    - name: deploy index.php file
      ansible.builtin.copy:
        dest: /var/www/html/index.php
        content: "<?php phpinfo(); ?>"